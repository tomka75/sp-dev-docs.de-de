---
title: "Einfügen eines Add-In-Webparts in das vom Anbieter gehostete Add-In"
description: Anzeigen eines Remotewebformulars in einer SharePoint-Seite in einer vom Anbieter gehosteten SharePoint-Add-In
ms.date: 11/02/2017
ms.prod: sharepoint
ms.openlocfilehash: 0bfdb5ad61a4d16ae11b1b8666e12953d154b7b4
ms.sourcegitcommit: 655e325aec73c8b7c6b5e3aaf71fbb4d2d223b5d
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 11/03/2017
---
# <a name="include-an-add-in-part-in-the-provider-hosted-add-in"></a><span data-ttu-id="1db0e-103">Einfügen eines Add-In-Webparts in das vom Anbieter gehostete Add-In</span><span class="sxs-lookup"><span data-stu-id="1db0e-103">Include an add-in part in the provider-hosted add-in</span></span>

<span data-ttu-id="1db0e-104">Dies ist der sechste in einer Reihe von Artikeln über die Grundlagen der Entwicklung von vom Anbieter gehosteten SharePoint-Add-Ins. Sie sollten sich zuerst mit [SharePoint Add-Ins](sharepoint-add-ins.md) und den vorherigen Artikeln in dieser Reihe vertraut machen:</span><span class="sxs-lookup"><span data-stu-id="1db0e-104">This is the sixth in a series of articles about the basics of developing provider-hosted SharePoint Add-ins. You should first be familiar with  [SharePoint Add-ins](sharepoint-add-ins.md) and the previous articles in this series:</span></span>

-  [<span data-ttu-id="1db0e-105">Erste Schritte beim Erstellen von vom Anbieter gehosteten SharePoint-Add-Ins</span><span class="sxs-lookup"><span data-stu-id="1db0e-105">Get started creating provider-hosted SharePoint Add-ins</span></span>](get-started-creating-provider-hosted-sharepoint-add-ins.md)
-  [<span data-ttu-id="1db0e-106">Übertragen des SharePoint-Aussehens und -Verhaltens auf Ihr vom Anbieter gehostetes Add-In</span><span class="sxs-lookup"><span data-stu-id="1db0e-106">Give your provider-hosted add-in the SharePoint look-and-feel</span></span>](give-your-provider-hosted-add-in-the-sharepoint-look-and-feel.md)
-  [<span data-ttu-id="1db0e-107">Einfügen einer benutzerdefinierten Schaltfläche in das vom Anbieter gehostete Add-In</span><span class="sxs-lookup"><span data-stu-id="1db0e-107">Include a custom button in the provider-hosted add-in</span></span>](include-a-custom-button-in-the-provider-hosted-add-in.md)
-  [<span data-ttu-id="1db0e-108">Schnelle Übersicht über das SharePoint-Objektmodell</span><span class="sxs-lookup"><span data-stu-id="1db0e-108">Get a quick overview of the SharePoint object model</span></span>](get-a-quick-overview-of-the-sharepoint-object-model.md)
-  [<span data-ttu-id="1db0e-109">Hinzufügen von SharePoint-Schreibvorgängen zum vom Anbieter gehosteten Add-In</span><span class="sxs-lookup"><span data-stu-id="1db0e-109">Add SharePoint write operations to the provider-hosted add-in</span></span>](add-sharepoint-write-operations-to-the-provider-hosted-add-in.md)
    
> [!NOTE]
> <span data-ttu-id="1db0e-110">Wenn Sie diese Reihe zu vom Anbieter gehosteten Add-Ins durchgearbeitet haben, können Sie das Thema mit einer Visual Studio-Lösung weiter vertiefen.</span><span class="sxs-lookup"><span data-stu-id="1db0e-110">Note  If you have been working through this series about provider-hosted add-ins, then you have a Visual Studio solution that you can use to continue with this topic. You can also download the repository at  SharePoint_Provider-hosted_Add-Ins_Tutorials and open the BeforeAdd-inPart.sln file.</span></span> <span data-ttu-id="1db0e-111">Sie können auch das Repository unter [SharePoint_Provider-hosted_Add-Ins_Tutorials](https://github.com/OfficeDev/SharePoint_Provider-hosted_Add-ins_Tutorials) herunterladen und die Datei BeforeAdd-inPart.sln öffnen.</span><span class="sxs-lookup"><span data-stu-id="1db0e-111">You can also download the repository at [SharePoint_Provider-hosted_Add-Ins_Tutorials](https://github.com/OfficeDev/SharePoint_Provider-hosted_Add-ins_Tutorials) and open the BeforeAdd-inPart.sln file.</span></span>

<span data-ttu-id="1db0e-112">In diesem Artikel fügen Sie einen besonderen Webpart-Typ namens Add-In-Webpart zu dem SharePoint-Add-In hinzu.</span><span class="sxs-lookup"><span data-stu-id="1db0e-112">In this article, you add a special kind of Web Part, called an add-in part to the SharePoint Add-in. The add-in part exposes the add-in's order form on a SharePoint page.</span></span> <span data-ttu-id="1db0e-113">Das Add-In-Webpart stellt das Add-In-Bestellformular auf einer SharePoint-Seite zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="1db0e-113">The add-in part exposes the add-in's order form on a SharePoint page.</span></span>

## <a name="create-the-add-in-part"></a><span data-ttu-id="1db0e-114">Erstellen des Add-In-Webparts</span><span class="sxs-lookup"><span data-stu-id="1db0e-114">Create the add-in part</span></span>

> [!NOTE]
> <span data-ttu-id="1db0e-115">Die Einstellungen für Startprojekte in Visual Studio werden in der Regel nach dem erneuten Öffnen wieder auf die Standardwerte eingestellt.</span><span class="sxs-lookup"><span data-stu-id="1db0e-115">NOTE The settings for Startup Projects in Visual Studio tend to revert to defaults whenever the solution is reopened. Always take these steps immediately after reopening the sample solution in this series of articles:</span></span> <span data-ttu-id="1db0e-116">Gehen Sie nach dem erneuten Öffnen der Beispiel-Lösung in dieser Artikelreihe immer folgendermaßen vor:</span><span class="sxs-lookup"><span data-stu-id="1db0e-116">Note  The settings for Startup Projects in Visual Studio tend to revert to defaults whenever the solution is reopened. Always take these steps immediately after reopening the sample solution in this series of articles:</span></span> 
> 1. <span data-ttu-id="1db0e-117">Klicken Sie mit der rechten Maustaste oben im **Projektmappen-Explorer** auf den Projektmappenknoten, und wählen Sie **Startprojekte festlegen** aus.</span><span class="sxs-lookup"><span data-stu-id="1db0e-117">Right-click the solution node at the top of  **Solution Explorer** and select **Set startup projects**.</span></span>  
> 2. <span data-ttu-id="1db0e-118">Stellen Sie sicher, dass alle drei Projekte in der Spalte **Aktion** auf **Start** festgelegt sind.</span><span class="sxs-lookup"><span data-stu-id="1db0e-118">Make sure all three projects are set to  **Start** in the **Action** column.</span></span>

1. <span data-ttu-id="1db0e-119">Klicken Sie im **Projektmappen-Explorer** mit der rechten Maustaste auf das **ChainStore**-Projekt, und wählen Sie **Hinzufügen** > **Neues Element** aus.</span><span class="sxs-lookup"><span data-stu-id="1db0e-119">In  Solution Explorer, right-click the  ChainStore project and select Add | New Item.</span></span>
    
2. <span data-ttu-id="1db0e-120">Wählen Sie **Client-Webpart (Hostweb)**, geben Sie dem Webpart den Namen **Bestellung absenden**, und wählen Sie dann **Hinzufügen** aus.</span><span class="sxs-lookup"><span data-stu-id="1db0e-120">Select  Client Web Part (Host Web), give it the name Place Order, and then press  Add. ("Client Web Part" is another name for "add-in part".)</span></span> <span data-ttu-id="1db0e-121">("Clientwebpart" ist ein anderer Name für "Webpart-Add-In").</span><span class="sxs-lookup"><span data-stu-id="1db0e-121">("Client Web Part" is another name for "add-in part".)</span></span>
 
3. <span data-ttu-id="1db0e-122">Wählen Sie auf der nächsten Seite des Assistenten die zweite Option aus: **URL einer vorhandenen Webseite für den Clientwebpart-Inhalt auswählen oder eingeben**.</span><span class="sxs-lookup"><span data-stu-id="1db0e-122">On the next page of the wizard, select the second radio button:  **Select or enter the URL of an existing web page for the client web part content**.</span></span>

4. <span data-ttu-id="1db0e-123">Wählen Sie in der Dropdownliste die URL für die Seite **OrderForm.aspx** aus, und wählen Sie dann **Fertig stellen** aus.</span><span class="sxs-lookup"><span data-stu-id="1db0e-123">In the drop down list, select the URL for the  **OrderForm.aspx** page, and then press **Finish**.</span></span>
    
   <span data-ttu-id="1db0e-124">Eine Datei „elements.xml“, die das Add-In-Webpart definiert, wird dem Projekt hinzugefügt und geöffnet.</span><span class="sxs-lookup"><span data-stu-id="1db0e-124">An elements.xml file that defines the add-in part is added to the project and opened.</span></span>
    
5. <span data-ttu-id="1db0e-125">Ändern Sie im Element **ClientWebPart** die folgenden Attribute auf die folgenden Werte:</span><span class="sxs-lookup"><span data-stu-id="1db0e-125">In the **ClientWebPart** element, change the following attributes to these values:</span></span>
   
    |<span data-ttu-id="1db0e-126">**Attribut**</span><span class="sxs-lookup"><span data-stu-id="1db0e-126">**Attribute**</span></span>|<span data-ttu-id="1db0e-127">**Wert**</span><span class="sxs-lookup"><span data-stu-id="1db0e-127">**Value**</span></span>|
    |:-----|:-----|
    |<span data-ttu-id="1db0e-128">Title</span><span class="sxs-lookup"><span data-stu-id="1db0e-128">Title</span></span>|<span data-ttu-id="1db0e-129">Bestellung absenden</span><span class="sxs-lookup"><span data-stu-id="1db0e-129">Place Order</span></span>|
    |<span data-ttu-id="1db0e-130">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="1db0e-130">Description</span></span>|<span data-ttu-id="1db0e-131">Formular zum Aufgeben einer Bestellung</span><span class="sxs-lookup"><span data-stu-id="1db0e-131">Form to place an order</span></span>|
    |<span data-ttu-id="1db0e-132">DefaultHeight</span><span class="sxs-lookup"><span data-stu-id="1db0e-132">DefaultHeight</span></span>|<span data-ttu-id="1db0e-133">320</span><span class="sxs-lookup"><span data-stu-id="1db0e-133">320</span></span>|

    <span data-ttu-id="1db0e-134">Behalten Sie für alle anderen Attribute die Standardwerte bei, und speichern Sie die Datei.</span><span class="sxs-lookup"><span data-stu-id="1db0e-134">Leave all the other attributes with their defaults and save the file.</span></span>
    
## <a name="run-the-add-in-and-test-the-add-in-part"></a><span data-ttu-id="1db0e-135">Ausführen des Add-Ins und Testen des Add-In-Websparts</span><span class="sxs-lookup"><span data-stu-id="1db0e-135">Run the add-in and test the add-in part</span></span>

1. <span data-ttu-id="1db0e-136">Verwenden Sie die F5-Taste, um Ihr Add-In auszuführen und bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="1db0e-136">Use the F5 key to deploy and run your add-in.</span></span> <span data-ttu-id="1db0e-137">Visual Studio hostet die remote Webanwendung in IIS Express und die SQL-Datenbank in SQL Express.</span><span class="sxs-lookup"><span data-stu-id="1db0e-137">Visual Studio hosts the remote web application in IIS Express and hosts the SQL database in SQL Express.</span></span> <span data-ttu-id="1db0e-138">Visual Studio führt zudem eine temporäre Installation des Add-Ins auf Ihrer SharePoint-Testwebsite durch und führt das Add-In sofort aus.</span><span class="sxs-lookup"><span data-stu-id="1db0e-138">Use the F5 key to deploy and run your add-in. Visual Studio makes a temporary installation of the add-in on your test SharePoint site and immediately runs the add-in.</span></span> <span data-ttu-id="1db0e-139">Sie werden aufgefordert, Berechtigungen für das Add-In zu erteilen, bevor die Startseite geöffnet wird.</span><span class="sxs-lookup"><span data-stu-id="1db0e-139">You are prompted to grant permissions to the add-in before its start page opens.</span></span>

2. <span data-ttu-id="1db0e-140">Wenn die Add-In-Startseite geöffnet wird, wurde das Add-In bereitgestellt, und das Add-In-Webpart **Bestellung absenden** steht Benutzern zum Hinzufügen zu einem beliebigen Webpart-Bereich auf einer beliebigen SharePoint-Seite der Hongkong Store-Website zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="1db0e-140">When the add-in's start page opens, the add-in has been deployed and the  **Place Order** add-in part is available to for users to add to any Web Part area on any SharePoint page in the Hong Kong store's website. Follow these steps to add it to the home page.</span></span> <span data-ttu-id="1db0e-141">Führen Sie die folgenden Schritte aus, um es zur Startseite hinzuzufügen:</span><span class="sxs-lookup"><span data-stu-id="1db0e-141">Follow these steps to add it to the home page:</span></span>
    
   1. <span data-ttu-id="1db0e-142">Wählen Sie **Zurück zur Website** im Chromsteuerelement am oberen Rand der Startseite, um die Homepage des Stores in Hongkong zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="1db0e-142">Press  **Back to Site** on the chrome control at the top of the start page to open the home page of the Hong Kong store.</span></span>
   2. <span data-ttu-id="1db0e-143">Öffnen Sie auf dem Menüband die Registerkarte **Seite**, und wählen Sie **Bearbeiten**.</span><span class="sxs-lookup"><span data-stu-id="1db0e-143">On the ribbon, open the  **Page** tab and press the **Edit** button.</span></span>
   3. <span data-ttu-id="1db0e-144">Nachdem sich die Seite im Bearbeitungsmodus befindet, öffnen Sie die Registerkarte **Einfügen** auf dem Menüband, und wählen Sie **Add-In-Webpart** (die Schaltfläche heißt möglicherweise immer noch **App-Webpart**).</span><span class="sxs-lookup"><span data-stu-id="1db0e-144">After the page is in edit mode, open the  **Insert** tab on the ribbon, and the press the **Add-in Part** button. (The button may still be called **App Part**.)</span></span>
   4. <span data-ttu-id="1db0e-145">Wählen Sie im geöffneten Webpart-Einfügesteuerelement das Add-In-Webpart **Bestellung absenden** aus.</span><span class="sxs-lookup"><span data-stu-id="1db0e-145">On the Web Part insertion control that opens, select the  **Place Order** add-in part. The control will look similar to the following.</span></span> <span data-ttu-id="1db0e-146">Das Steuerelement sieht ähnlich aus wie folgt.</span><span class="sxs-lookup"><span data-stu-id="1db0e-146">The control looks similar to the following.</span></span>

      <span data-ttu-id="1db0e-147">*Abbildung 1. Webpart-Einfügesteuerelement in SharePoint*</span><span class="sxs-lookup"><span data-stu-id="1db0e-147">*Figure 1. SharePoint's Web Part insertion control*</span></span>

      ![Das Webpart-Einfügesteuerelement in SharePoint. Das Webpart „Bestellung absenden“ ist hervorgehoben. Sein Name und seine Beschreibung werden in einem Feld auf der rechten Seite angezeigt.](../images/aae61f89-2e9e-4808-8b0c-2439dad7c701.PNG)

   5. <span data-ttu-id="1db0e-151">Wählen Sie in eine beliebige Webpartzone im Formular, um den Standort festzulegen, an dem das Add-In-Webpart eingefügt wird.</span><span class="sxs-lookup"><span data-stu-id="1db0e-151">Click somewhere in one of the Web Part zones of the form. This is to set the location where the add-in part will go.</span></span> 
   6. <span data-ttu-id="1db0e-152">Wählen Sie **Hinzufügen** im Webpart-Einfügesteuerelement aus.</span><span class="sxs-lookup"><span data-stu-id="1db0e-152">Select **Add** on the Web Part insertion control.</span></span> <span data-ttu-id="1db0e-153">Das Add-In-Webpart **Bestellung absenden** wird zur Webpartzone hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="1db0e-153">Click  Add on the Web Part insertion control. The **Place Order** add-in part will be added to the Web Part zone.</span></span>
   7. <span data-ttu-id="1db0e-154">Wählen Sie im Menüband **Speichern**.</span><span class="sxs-lookup"><span data-stu-id="1db0e-154">On the ribbon press  **Save**.</span></span>
    
3. <span data-ttu-id="1db0e-155">Das Bestellformular wird nun auf der Seite angezeigt und hat das Aussehen und Verhalten des Rests der Seite übernommen.</span><span class="sxs-lookup"><span data-stu-id="1db0e-155">The order form now appears on the page and it has the look-and-feel of the rest of the page. It should look like the following:</span></span> <span data-ttu-id="1db0e-156">Es sollte wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="1db0e-156">Add the implementation for IRibbonExtensibility. It should look something like the following code.</span></span> 
    
   <span data-ttu-id="1db0e-157">*Abbildung 2. Add-In-Webpart „Bestellung absenden“*</span><span class="sxs-lookup"><span data-stu-id="1db0e-157">*Figure 2. Place Order add-in part*</span></span>

   ![Das Add-In-Webpart „Bestellung absenden“ auf der Seite mit Textfeldern für Produkt, Lieferant und Menge. Auch eine Schaltfläche „Bestellung absenden“ ist verfügbar.](../images/beae2e3c-c1f4-4334-8ab8-0c42252cb2a2.PNG)

4. <span data-ttu-id="1db0e-160">Geben Sie Werte für **Lieferant**, **Produkt** und **Menge** ein, und wählen Sie dann **Bestellung absenden**.</span><span class="sxs-lookup"><span data-stu-id="1db0e-160">Enter values for **Supplier**, **Product**, and **Quantity**, and then select **Place Order**.</span></span> <span data-ttu-id="1db0e-161">Augenscheinlich geschieht nichts, aber eine Bestellung wird in der Datenbank des Unternehmens eingegeben.</span><span class="sxs-lookup"><span data-stu-id="1db0e-161">Nothing appears to happen, but an order is entered in the corporate database.</span></span> <span data-ttu-id="1db0e-162">Optional können Sie die Felder des Add-In-Webparts leeren, indem Sie die Seite aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="1db0e-162">Optionally, you can empty the fields of the add-in part by refreshing the page.</span></span>

5. <span data-ttu-id="1db0e-163">Verwenden Sie im Browser die Schaltfläche „Zurück“, bis Sie wieder auf die Startseite für das ChainStore-Add-In zurückgekehrt sind, und wählen Sie dann die Schaltfläche **Bestellungen anzeigen**.</span><span class="sxs-lookup"><span data-stu-id="1db0e-163">Use the browser's back button until you are back at the Chain Store add-in's start page; and then press  **Show Orders**. Your new order is listed.</span></span> <span data-ttu-id="1db0e-164">Ihre neue Bestellung wird jetzt aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="1db0e-164">Your new order is listed.</span></span>

6. <span data-ttu-id="1db0e-165">Schließen Sie zum Beenden der Debugsitzung das Browserfenster, oder beenden Sie das Debuggen in Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="1db0e-165">To end the debugging session, close the browser window or stop debugging in Visual Studio. Each time that you press F5, Visual Studio will retract the previous version of the add-in and install the latest one.</span></span> <span data-ttu-id="1db0e-166">Jedes Mal, wenn Sie F5 drücken, zieht Visual Studio die vorherige Version des Add-Ins zurück und installiert die neueste.</span><span class="sxs-lookup"><span data-stu-id="1db0e-166">Each time you select F5, Visual Studio retracts the previous version of the add-in and installs the latest one.</span></span>

7. <span data-ttu-id="1db0e-167">Da Sie mit diesem Add-In und dieser Visual Studio-Lösung in anderen Artikeln arbeiten werden, hat es sich bewährt, das Add-In ein letztes Mal zurückzuziehen, wenn Sie Ihre Arbeit daran für eine Weile abgeschlossen haben.</span><span class="sxs-lookup"><span data-stu-id="1db0e-167">You will work with this add-in and Visual Studio solution in other articles, and it's a good practice to retract the add-in one last time when you are done working with it for a while. Right-click the project in  Solution Explorer and choose Retract.</span></span> <span data-ttu-id="1db0e-168">Klicken Sie mit der rechten Maustaste auf das Projekt im **Projektmappen-Explorer**, und wählen Sie **Zurückziehen** aus.</span><span class="sxs-lookup"><span data-stu-id="1db0e-168">Right-click the project in  **Solution Explorer** and choose **Retract**.</span></span>

## <a name="next-steps"></a><span data-ttu-id="1db0e-169">Nächste Schritte</span><span class="sxs-lookup"><span data-stu-id="1db0e-169">Next steps</span></span>
<span data-ttu-id="1db0e-170"><a name="Nextsteps"> </a></span><span class="sxs-lookup"><span data-stu-id="1db0e-170"></span></span>

<span data-ttu-id="1db0e-171">Das Add-In hängt von zwei Listen ab, die Sie manuell erstellt haben; Ihre Benutzer müssen keine Listen erstellen. </span><span class="sxs-lookup"><span data-stu-id="1db0e-171">The add-in depends on two lists that you created manually; you don't want your users to have to do that.</span></span> <span data-ttu-id="1db0e-172">Im nächsten Artikel wird erklärt, wie Sie diese Listen automatisch erstellen.</span><span class="sxs-lookup"><span data-stu-id="1db0e-172">In the next article, you begin the process of automatically creating these lists.</span></span> <span data-ttu-id="1db0e-173">Zunächst müssen Sie benutzerdefinierte Handler für das Ereignis der Installation eines Add-Ins erstellen: [Behandeln von Add-In-Ereignissen im vom Anbieter gehosteten Add-In](handle-add-in-events-in-the-provider-hosted-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="1db0e-173">The first major step is to create custom handlers for the event of installing an add-in: [Handle add-in events in the provider-hosted add-in](handle-add-in-events-in-the-provider-hosted-add-in.md).</span></span>
 

 

