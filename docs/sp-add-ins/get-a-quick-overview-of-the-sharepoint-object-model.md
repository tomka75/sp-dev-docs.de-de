---
title: "Schnelle Übersicht über das SharePoint-Objektmodell"
description: "Einführung in die Inhaltshierarchie sowie die clientseitige Runtime und Batchverarbeitung"
ms.date: 12/04/2017
ms.prod: sharepoint
ms.openlocfilehash: 6ba56b1f8cfd114844d36506090e97a2fc17808b
ms.sourcegitcommit: 0a94e0c600db24a1b5bf5895e6d3d9681bf7c810
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 12/07/2017
---
# <a name="get-a-quick-overview-of-the-sharepoint-object-model"></a><span data-ttu-id="3fdee-103">Kurzübersicht über das SharePoint-Objektmodell</span><span class="sxs-lookup"><span data-stu-id="3fdee-103">Get a quick overview of the SharePoint object model</span></span>

<span data-ttu-id="3fdee-104">Dies ist der vierte einer Reihe von Artikeln über die Grundlagen der Entwicklung von vom Anbieter gehosteten SharePoint-Add-Ins. Machen Sie sich zunächst mit [SharePoint-Add-Ins](sharepoint-add-ins.md) und den vorherigen Artikeln dieser Reihe vertraut, die Sie unter [Erste Schritte beim Erstellen von von einem Anbieter gehosteten SharePoint-Add-Ins](get-started-creating-provider-hosted-sharepoint-add-ins.md#SP15createprovider_nextsteps) finden.</span><span class="sxs-lookup"><span data-stu-id="3fdee-104">This is the fourth in a series of articles about the basics of developing provider-hosted SharePoint Add-ins. You should first be familiar with [SharePoint Add-ins](sharepoint-add-ins.md) and the previous articles in this series:</span></span> 
 
> [!NOTE]
> <span data-ttu-id="3fdee-105">Wenn Sie unsere Artikelreihe zum Thema anbietergehostete Add-Ins durchgearbeitet haben, haben Sie bereits eine Visual Studio-Lösung, die Sie für diesen Artikel verwenden können.</span><span class="sxs-lookup"><span data-stu-id="3fdee-105">If you have been working through this series about provider-hosted add-ins, you have a Visual Studio solution that you can use to continue with this topic.</span></span> <span data-ttu-id="3fdee-106">Sie können auch das Repository unter [SharePoint_Provider-hosted_Add-Ins_Tutorials](https://github.com/OfficeDev/SharePoint_Provider-hosted_Add-ins_Tutorials) herunterladen und die Datei BeforeSharePointWriteOps.sln öffnen.</span><span class="sxs-lookup"><span data-stu-id="3fdee-106">You can also download the repository at [SharePoint_Provider-hosted_Add-Ins_Tutorials](https://github.com/OfficeDev/SharePoint_Provider-hosted_Add-ins_Tutorials) and open the BeforeSharePointWriteOps.sln file.</span></span>

<span data-ttu-id="3fdee-107">In diesem Artikel legen Sie eine kurze Pause vom Codieren ein, um einen schnellen Überblick über das SharePoint-Clientobjektmodell (CSOM) zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="3fdee-107">In this article you'll take a brief break from coding to get a quick overview of the SharePoint Client-side Object Model (CSOM).</span></span> <span data-ttu-id="3fdee-108">Dieses Modell ist durch Referenzthemen, Vorgehensweisen und Codebeispiele ausführlich und gut in MSDN dokumentiert.</span><span class="sxs-lookup"><span data-stu-id="3fdee-108">This model is large and well-documented in MSDN with reference topics, "how-to's", and code samples.</span></span> <span data-ttu-id="3fdee-109">In diesem Artikel können wir nur einen ganz kurzen Einblick liefern.</span><span class="sxs-lookup"><span data-stu-id="3fdee-109">In this article, we can only provide the tip of the tip of the tip of the iceberg.</span></span> <span data-ttu-id="3fdee-110">Doch selbst eine sehr kurze Einführung wird bewirken, dass Ihnen ein Großteil des Codes dieser Reihe weitaus weniger rätselhaft erscheint.</span><span class="sxs-lookup"><span data-stu-id="3fdee-110">But even a very short introduction will make much of the code you see in this series a lot less mysterious.</span></span> 

## <a name="content-hierarchy"></a><span data-ttu-id="3fdee-111">Inhaltshierarchie</span><span class="sxs-lookup"><span data-stu-id="3fdee-111">Content hierarchy</span></span>

<span data-ttu-id="3fdee-112">Die folgende Tabelle zeigt die Hierarchie der Inhalte in SharePoint und deren Darstellung durch CSOM-Klassen.</span><span class="sxs-lookup"><span data-stu-id="3fdee-112">The following table shows the hierarchy of content in SharePoint and the CSOM classes that represent them.</span></span> <span data-ttu-id="3fdee-113">Alle Entitäten verfügen über untergeordnete Dateien.</span><span class="sxs-lookup"><span data-stu-id="3fdee-113">Each of these entities has children of the type just under it.</span></span>
 

|<span data-ttu-id="3fdee-114">**Entität**</span><span class="sxs-lookup"><span data-stu-id="3fdee-114">**Entity**</span></span>|<span data-ttu-id="3fdee-115">**Klasse**</span><span class="sxs-lookup"><span data-stu-id="3fdee-115">**Class**</span></span>|<span data-ttu-id="3fdee-116">**Bemerkungen**</span><span class="sxs-lookup"><span data-stu-id="3fdee-116">**Remarks**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="3fdee-117">Lokale SharePoint-Farm oder SharePoint Online-Abonnement (auch als Mandant bezeichnet)</span><span class="sxs-lookup"><span data-stu-id="3fdee-117">SharePoint on-premises farm or SharePoint Online subscription (also called a tenant)</span></span>||<span data-ttu-id="3fdee-p104">Es gibt nur eingeschränkten programmgesteuerten Zugriff auf diese Ebene in CSOM. Es gibt z. B. keine Klasse „Farm" oder „Abonnements" oder „Mandant". (Das serverseitige SharePoint-Objektmodell, das in Add-Ins nicht verwendet werden kann, ermöglicht den programmgesteuerten Zugriff auf diese Entitäten.)</span><span class="sxs-lookup"><span data-stu-id="3fdee-p104">There is only limited programmatic access to this level in CSOM. There is no Farm or Subscription or Tenant class, for example. (SharePoint's server-side object model, which cannot be used in add-ins, enables programmatic access to these entities.)</span></span>|
|<span data-ttu-id="3fdee-121">Websitesammlung</span><span class="sxs-lookup"><span data-stu-id="3fdee-121">site collection</span></span>|<span data-ttu-id="3fdee-122">**Website**</span><span class="sxs-lookup"><span data-stu-id="3fdee-122">**Site**</span></span>|<span data-ttu-id="3fdee-123">Eine Sammlung von Websites, die hauptsächlich aus administrativen Gründen und zum Unterbringen von SharePoint-Komponenten wie firmenspezifischen Masterseiten oder benutzerdefinierten Sicherheitsgruppen gruppiert werden und für alle untergeordneten Websites angewendet werden können.</span><span class="sxs-lookup"><span data-stu-id="3fdee-123">A collection of websites that are grouped together for mainly administrative reasons and to house SharePoint components, such as branded master pages or custom security groups, that can be applied to all the child websites.</span></span> <span data-ttu-id="3fdee-124">Alle Websites gehören zu einer Websitesammlung.</span><span class="sxs-lookup"><span data-stu-id="3fdee-124">All websites belong to some site collection.</span></span>|
|<span data-ttu-id="3fdee-125">Website</span><span class="sxs-lookup"><span data-stu-id="3fdee-125">website</span></span>|<span data-ttu-id="3fdee-126">**Web**</span><span class="sxs-lookup"><span data-stu-id="3fdee-126">**Web**</span></span>|<span data-ttu-id="3fdee-p106">Eine Reihe von Seiten und SharePoint-Komponenten, die Unterwebsites haben können.</span><span class="sxs-lookup"><span data-stu-id="3fdee-p106">A set of pages and SharePoint components. Can have subwebsites.</span></span>|
|<span data-ttu-id="3fdee-129">Liste</span><span class="sxs-lookup"><span data-stu-id="3fdee-129">list</span></span>|<span data-ttu-id="3fdee-130">**List**</span><span class="sxs-lookup"><span data-stu-id="3fdee-130">**List**</span></span>|<span data-ttu-id="3fdee-p107">Dokumentbibliotheken und andere Arten von Dateibibliotheken sind ebenfalls auf dieser Ebene. Eine Dokumentbibliothek ist eine besondere Art von Liste, in der jede Zeile ein angefügtes Dokument enthält und die anderen Spalten Daten über das Dokument sind, z. B. der Autor, wann es zuletzt bearbeitet wurde und wer es ausgecheckt hat.</span><span class="sxs-lookup"><span data-stu-id="3fdee-p107">Document libraries and other kinds of file libraries are also at this level. A document library is a special kind of list in which each row includes an attached document, and the other columns are data about the document, such as its author, when it was last edited, and who has it checked out.</span></span> |
|<span data-ttu-id="3fdee-133">Listenelement</span><span class="sxs-lookup"><span data-stu-id="3fdee-133">list item</span></span>|<span data-ttu-id="3fdee-134">**ListItem**</span><span class="sxs-lookup"><span data-stu-id="3fdee-134">**ListItem**</span></span>|<span data-ttu-id="3fdee-p108">Eine Zeile in einer Liste, d. h. ein Listenelement mit bestimmten Werten in den Feldern der Zeile. Es hat auch einen Typ. Mehr dazu in der nächsten Zeile.</span><span class="sxs-lookup"><span data-stu-id="3fdee-p108">A row in a list—that is, a list item—with particular values in the fields of the row. Also has a type. See next row.</span></span> |
|<span data-ttu-id="3fdee-138">Listenelement</span><span class="sxs-lookup"><span data-stu-id="3fdee-138">list item</span></span>|<span data-ttu-id="3fdee-139">**Inhaltstyp**</span><span class="sxs-lookup"><span data-stu-id="3fdee-139">**Content Type**</span></span>|<span data-ttu-id="3fdee-p109">Der Typ eines Listenelements. Diese werden von der Klasse **ContentType** dargestellt und sind im Wesentlichen eine Reihe von Spalten und Metadaten. Der einfachste Typ ist der integrierte **Item**-Inhaltstyp. Alle anderen Inhaltstypen werden von **Item** abgeleitet. SharePoint enthält viele integrierte Inhaltstypen, z. B. Ereignis und Ankündigung. </span><span class="sxs-lookup"><span data-stu-id="3fdee-p109">The type of a list item. These are represented by the  **ContentType** class. Each is basically a set of columns and metadata. The simplest is the built-in **Item** content type. All other content types are derived from **Item**. SharePoint includes many built-in content types, such as Event and Announcement.</span></span> |
|<span data-ttu-id="3fdee-146">Spalte</span><span class="sxs-lookup"><span data-stu-id="3fdee-146">column</span></span>|<span data-ttu-id="3fdee-147">**Field**</span><span class="sxs-lookup"><span data-stu-id="3fdee-147">**Field**</span></span>|<span data-ttu-id="3fdee-148">Ein **Field**-Objekt enthält nicht nur Informationen zum zugrunde liegenden Datentyp, sondern auch Informationen darüber, wie die Daten formatiert und in Formularen gerendert werden, z. B. in Formularen zum Erstellen, Anzeigen und Bearbeiten bestimmter Listenelemente.</span><span class="sxs-lookup"><span data-stu-id="3fdee-148">A  **Field** object includes not only information about the underlying data type, but also information about how the data is formatted and rendered on forms, such as the forms for creating, displaying, and editing specific list items.</span></span>|

<span data-ttu-id="3fdee-149">Sie können benutzerdefinierte Listen, Inhaltstypen, Spaltentypen und Listenelemente programmgesteuert erstellen.</span><span class="sxs-lookup"><span data-stu-id="3fdee-149">You can programmatically create custom lists, content types, column types, and list items.</span></span> 

<span data-ttu-id="3fdee-150">Zusätzlich zum Inhalt ermöglicht das CSOM den Zugriff auf Benutzer, Gruppen, Rollen und Berechtigungen, Taxonomie, Suche und mehr.</span><span class="sxs-lookup"><span data-stu-id="3fdee-150">In addition to content, the CSOM gives you access to users, groups, roles and permissions, taxonomy, search, and more.</span></span>

<span data-ttu-id="3fdee-151"><a name="CSOMBatching"> </a></span><span class="sxs-lookup"><span data-stu-id="3fdee-151"></span></span>
## <a name="client-side-runtime-and-batching"></a><span data-ttu-id="3fdee-152">Clientseitige Runtime und Batchverarbeitung</span><span class="sxs-lookup"><span data-stu-id="3fdee-152">Client-side runtime and batching</span></span>

<span data-ttu-id="3fdee-153">CSOM verwendet ein Batchverarbeitungssystem.</span><span class="sxs-lookup"><span data-stu-id="3fdee-153">CSOM uses a batching system.</span></span> <span data-ttu-id="3fdee-154">Datenteile aus verwaltetem Code werden in XML-Code konvertiert und in einer einzelnen HTTP-Anforderung an den Server gesendet.</span><span class="sxs-lookup"><span data-stu-id="3fdee-154">Chunks of managed code are converted into XML and sent to the server in a single HTTP request.</span></span> <span data-ttu-id="3fdee-155">Für jeden Befehl erfolgt ein entsprechender Serverobjektmodell-Aufruf, und der Server gibt eine Antwort an den Client im Format JavaScript Object Notation (JSON) zurück.</span><span class="sxs-lookup"><span data-stu-id="3fdee-155">For every command, a corresponding server object model call is made, and the server returns a response to the client in JavaScript Object Notation (JSON) format.</span></span> 

<span data-ttu-id="3fdee-156">SharePoint-Code auf einem Client beginnt mit dem Abrufen eines Clientkontextobjekts, das den aktuellen Anforderungskontext darstellt, einschließlich der Identität der SharePoint-Website (und ihrer übergeordneten Websitesammlung). Durch diesen Kontext können Sie Zugriff auf CSOM-Objekte erhalten.</span><span class="sxs-lookup"><span data-stu-id="3fdee-156">SharePoint code on a client begins by retrieving a client context object that represents the current request context, including the identity of the SharePoint website (and its parent site collection), and through this context you can obtain access to CSOM objects.</span></span> <span data-ttu-id="3fdee-157">Im Folgenden ist die grundlegende Struktur abgebildet, die Sie immer wieder sehen werden.</span><span class="sxs-lookup"><span data-stu-id="3fdee-157">The following is the basic structure that you will see again and again.</span></span> 

```C#
  using (var clientContext = spContext.CreateUserClientContextForSPHost())
  {
      // CRUD operation or query code goes here.

      clientContext.ExecuteQuery();
  }
```

<span data-ttu-id="3fdee-158">Beachten Sie Folgendes bei diesem Code:</span><span class="sxs-lookup"><span data-stu-id="3fdee-158">Note the following about this code:</span></span>

- <span data-ttu-id="3fdee-159">Das `spContext`-Objekt ist vom Typ **SharePointContext** und in der Datei SharePointContext.cs (oder .vb) definiert, die von den Office Developer Tools für Visual Studio generiert wird.</span><span class="sxs-lookup"><span data-stu-id="3fdee-159">The `spContext` object is of the type **SharePointContext** and is defined in the SharePointContext.cs (or .vb) file that is generated by the Office Developer Tools for Visual Studio.</span></span> <span data-ttu-id="3fdee-160">Diese Datei kann geändert werden, aber dies ist in den meisten Fällen nicht notwendig.</span><span class="sxs-lookup"><span data-stu-id="3fdee-160">This file can be modified, but it is not often that you need to do so.</span></span> <span data-ttu-id="3fdee-161">Bei den meisten SharePoint-Add-In-Projekten funktionieren diese Datei und die Datei TokenHelper.cs (oder .vb), die ebenfalls von den Tools generiert wird, effektiv als Erweiterungen des CSOM.</span><span class="sxs-lookup"><span data-stu-id="3fdee-161">For most SharePoint Add-in projects, this file and the TokenHelper.cs (or .vb) file, which is also generated by the tools, effectively function as extensions of CSOM itself.</span></span>

- <span data-ttu-id="3fdee-162">Das `clientContext`-Objekt ist der CSOM-Typ **ClientContext**.</span><span class="sxs-lookup"><span data-stu-id="3fdee-162">The `clientContext` object is the CSOM type **ClientContext**.</span></span>

- <span data-ttu-id="3fdee-163">Die **ExecuteQuery**-Methode bündelt den CRUD-Vorgangscode in einer XML-Nachricht, die an den SharePoint-Server gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="3fdee-163">The **ExecuteQuery** method bundles up the CRUD operation code in an XML message that it sends to the SharePoint server.</span></span> <span data-ttu-id="3fdee-164">Dort wird der Code in den entsprechenden serverseitige Modellobjektcode übertragen und ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="3fdee-164">There it is translated into equivalent server-side object model code and executed.</span></span>

<span data-ttu-id="3fdee-165">Im vorherigen Artikel dieser Reihe war ein Beispiel dieses Musters in der gezeigten Methode `GetLocalEmployeeName` dargestellt.</span><span class="sxs-lookup"><span data-stu-id="3fdee-165">There was an example of this pattern in the previous article of this series, in the `GetLocalEmployeeName` method shown here.</span></span> 

```C#
private string GetLocalEmployeeName()
{
    ListItem localEmployee;

    using (var clientContext = spContext.CreateUserClientContextForSPHost())
    {
        List localEmployeesList = clientContext.Web.Lists.GetByTitle("Local Employees");
        selectedLocalEmployee = localEmployeesList.GetItemById(listItemID);
        clientContext.Load(selectedLocalEmployee);
        clientContext.ExecuteQuery();
    }
    return localEmployee["Title"].ToString();
}
```

<span data-ttu-id="3fdee-166">Beachten Sie Folgendes zu dieser Methode:</span><span class="sxs-lookup"><span data-stu-id="3fdee-166">Note the following about this method:</span></span>

- <span data-ttu-id="3fdee-p114">Die ersten beiden Zeilen im **using**-Block scheinen Verweise auf die Liste und das Listenelementobjekt abzurufen. Aber tatsächlich werden diese Zeilen, wenn sie in der clientseitigen SharePoint-Laufzeit ausgeführt werden, einfach in ein XML-Format übersetzt. Die Methode **ExecuteQuery** sendet diese XML an den Server.</span><span class="sxs-lookup"><span data-stu-id="3fdee-p114">The first two lines in the **using** block appear to get references to the list and the list item object. But actually when these lines execute in the SharePoint client-side runtime, they are simply translated into an XML format. The **ExecuteQuery** method sends that XML to the server.</span></span>

-  <span data-ttu-id="3fdee-170">Mit der **Laden**-Methode wird etwas zur der Nachricht hinzugefügt: Dem Server wird aufgetragen, das angegebene Objekt auf den Client zu übertragen.</span><span class="sxs-lookup"><span data-stu-id="3fdee-170">The **Load** method adds something extra to the message: it tells the server to send the specified object down to the client.</span></span> <span data-ttu-id="3fdee-171">Die **ExecuteQuery**-Methode empfängt dieses Objekt (als JSON) und verwendet es, um die clientseitige Variable `selectedLocalEmployee` zu initialisieren.</span><span class="sxs-lookup"><span data-stu-id="3fdee-171">The **ExecuteQuery** method receives this object (as JSON) and uses it to initialize the client-side `selectedLocalEmployee` variable.</span></span> <span data-ttu-id="3fdee-172">Nachfolgender clientseitiger Code verweist dann auf dieses **ListItem**-Objekt und seine Elemente.</span><span class="sxs-lookup"><span data-stu-id="3fdee-172">Subsequent client-side code then references that **ListItem** object and its members.</span></span> <span data-ttu-id="3fdee-173">Wie Sie sehen, verweist die nächste Zeile auf den Wert des Feldes `"Title"` des Elements.</span><span class="sxs-lookup"><span data-stu-id="3fdee-173">As you can see, the next line references the value of the item's `"Title"` field.</span></span> <span data-ttu-id="3fdee-174">Diese Zeile würde eine Ausnahme auslösen, wenn die **Laden**-Methode nicht aufgerufen worden wäre, da das Objekt erst auf der Clientseite vorhanden ist, nachdem es geladen wurde.</span><span class="sxs-lookup"><span data-stu-id="3fdee-174">This line would have thrown an exception if the **Load** method had not been called because the object doesn't really exist on the client-side until it is loaded.</span></span>
 
## <a name="next-steps"></a><span data-ttu-id="3fdee-175">Nächste Schritte</span><span class="sxs-lookup"><span data-stu-id="3fdee-175">Next steps</span></span>
<span data-ttu-id="3fdee-176"><a name="Nextsteps"> </a></span><span class="sxs-lookup"><span data-stu-id="3fdee-176"></span></span>

<span data-ttu-id="3fdee-177">Im nächsten Artikel kehren wir zum Programmieren zurück, und Sie erfahren, wie Sie [SharePoint-Schreibvorgänge zum einem vom Anbieter gehosteten Add-In hinzufügen](add-sharepoint-write-operations-to-the-provider-hosted-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="3fdee-177">In the next article, we get back to coding and learn how to [add SharePoint write operations to the provider-hosted add-in](add-sharepoint-write-operations-to-the-provider-hosted-add-in.md).</span></span>
 

 

