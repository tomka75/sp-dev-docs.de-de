---
title: "Hinzufügen eines Workflows zu einem von SharePoint gehosteten SharePoint-Add-In"
description: "Informationen zum Hinzufügen eines Workflows zu einem Add-in, Entwerfen des Workflows sowie Ausführen und Testen des Add-Ins."
ms.date: 11/02/2017
ms.prod: sharepoint
ms.openlocfilehash: 31773951351ec718e5ce7826d5382ae1dbea72c0
ms.sourcegitcommit: 655e325aec73c8b7c6b5e3aaf71fbb4d2d223b5d
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 11/03/2017
---
# <a name="add-a-workflow-to-a-sharepoint-hosted-sharepoint-add-in"></a><span data-ttu-id="f6576-103">Hinzufügen eines Workflows zu einem von SharePoint gehosteten SharePoint-Add-In</span><span class="sxs-lookup"><span data-stu-id="f6576-103">Add a workflow to a SharePoint-hosted SharePoint Add-in</span></span>

<span data-ttu-id="f6576-104">Dies ist der sechste in einer Reihe von Artikeln über die Grundlagen der Entwicklung von SharePoint gehosteter SharePoint-Add-Ins. Machen Sie sich zunächst mit [SharePoint-Add-Ins](sharepoint-add-ins.md) und den vorherigen Artikeln in dieser Reihe vertraut:</span><span class="sxs-lookup"><span data-stu-id="f6576-104">This is the sixth in a series of articles about the basics of developing SharePoint-hosted SharePoint Add-ins. You should first be familiar with  [SharePoint Add-ins](sharepoint-add-ins.md) and the previous articles in this series:</span></span>
 
- [<span data-ttu-id="f6576-105">Erste Schritte beim Erstellen von von SharePoint gehosteten SharePoint-Add-Ins</span><span class="sxs-lookup"><span data-stu-id="f6576-105">Get started creating SharePoint-hosted SharePoint Add-ins</span></span>](get-started-creating-sharepoint-hosted-sharepoint-add-ins.md)
- [<span data-ttu-id="f6576-106">Bereitstellung und Installation eines von SharePoint gehosteten Add-Ins für SharePoint</span><span class="sxs-lookup"><span data-stu-id="f6576-106">Deploy and install a SharePoint-hosted SharePoint Add-in</span></span>](deploy-and-install-a-sharepoint-hosted-sharepoint-add-in.md)
- [<span data-ttu-id="f6576-107">Hinzufügen von benutzerdefinierten Spalten zu einem von SharePoint gehosteten SharePoint-Add-In</span><span class="sxs-lookup"><span data-stu-id="f6576-107">Add custom columns to a SharePoint-hosted SharePoint Add-in</span></span>](add-custom-columns-to-a-sharepoint-hosted-sharepoint-add-in.md)
- [<span data-ttu-id="f6576-108">Hinzufügen eines benutzerdefinierten Inhaltstyps zu einem von SharePoint gehosteten SharePoint-Add-In</span><span class="sxs-lookup"><span data-stu-id="f6576-108">Add a custom content type to a SharePoint-hosted SharePoint Add-in</span></span>](add-a-custom-content-type-to-a-sharepoint-hosted-sharepoint-add-in.md)
- [<span data-ttu-id="f6576-109">Hinzufügen eines Webparts zu einer Seite in einem von SharePoint gehosteten Add-In für SharePoint</span><span class="sxs-lookup"><span data-stu-id="f6576-109">Add a Web Part to a page in a SharePoint-hosted SharePoint Add-in</span></span>](add-a-web-part-to-a-page-in-a-sharepoint-hosted-sharepoint-add-in.md)


> [!NOTE]
> <span data-ttu-id="f6576-110">Wenn Sie diese Reihe zu von SharePoint gehosteten Add-Ins durchgearbeitet haben, können Sie das Thema mit einer Visual Studio-Lösung weiter vertiefen.</span><span class="sxs-lookup"><span data-stu-id="f6576-110">Note  If you have been working through this series about SharePoint-hosted add-ins, then you have a Visual Studio solution that you can use to continue with this topic. You can also download the repository at  SharePoint_SP-hosted_Add-Ins_Tutorials and open the BeforeClientRenderedControl.sln file.</span></span> <span data-ttu-id="f6576-111">Sie können auch das Repository unter [SharePoint_SP-hosted_Add-Ins_Tutorials](https://github.com/OfficeDev/SharePoint_SP-hosted_Add-Ins_Tutorials) herunterladen und die Datei „BeforeWorkflow.sln“ öffnen.</span><span class="sxs-lookup"><span data-stu-id="f6576-111">You can also download the repository at [SharePoint_SP-hosted_Add-Ins_Tutorials](https://github.com/OfficeDev/SharePoint_SP-hosted_Add-Ins_Tutorials) and open the BeforeWorkflow.sln file.</span></span>

<span data-ttu-id="f6576-112">In diesem Artikel fügen Sie einen Workflow im SharePoint-Add-In „Orientierung für Mitarbeiter“ hinzu, der die Personalabteilung (HR) benachrichtigt, dass ein neuer Mitarbeiter bereit ist, die Personalpapiere auszufüllen.</span><span class="sxs-lookup"><span data-stu-id="f6576-112">In this article you add a workflow the Employee Orientation SharePoint Add-in that notifies the Human Resources (HR) department that a new employee is ready to fill out the HR paperwork.</span></span>

## <a name="add-a-workflow-to-an-add-in"></a><span data-ttu-id="f6576-113">Hinzufügen eines Workflows zu einem Add-In</span><span class="sxs-lookup"><span data-stu-id="f6576-113">Add a workflow to an add-in</span></span>

1. <span data-ttu-id="f6576-114">Klicken Sie im **Projektmappen-Explorer** mit der rechten Maustaste auf das Projekt, und wählen Sie **Hinzufügen** > **Neuer Ordner** aus.</span><span class="sxs-lookup"><span data-stu-id="f6576-114">In **Solution Explorer**, right-click the project, and select **Add** > **New Folder**.</span></span> <span data-ttu-id="f6576-115">Nennen Sie den Ordner **Workflows**.</span><span class="sxs-lookup"><span data-stu-id="f6576-115">Name the folder **Workflows**.</span></span>
    
2. <span data-ttu-id="f6576-116">Klicken Sie mit der rechten Maustaste auf den neuen Ordner, und wählen Sie **Hinzufügen** > **Neues Element** aus.</span><span class="sxs-lookup"><span data-stu-id="f6576-116">Right-click the new folder, and select **Add** > **New Item**.</span></span> <span data-ttu-id="f6576-117">Das Dialogfeld **Neues Element hinzufügen** wird geöffnet, und der **Office/SharePoint**-Knoten wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="f6576-117">Right-click the new folder and choose  AddNew Item. The  **Add New Item** dialog opens to the **Office/SharePoint** node.</span></span>
    
3. <span data-ttu-id="f6576-118">Wählen Sie **Workflow** aus, und geben Sie ihm den Namen **HR_Intake**.</span><span class="sxs-lookup"><span data-stu-id="f6576-118">Select **Workflow** and give it the name **HR_Intake**.</span></span> <span data-ttu-id="f6576-119">Wenn Sie aufgefordert werden, den Workflowtyp auszuwählen, wählen Sie **Listenworkflow** und dann **Weiter** aus.</span><span class="sxs-lookup"><span data-stu-id="f6576-119">When prompted to select the type of workflow, select **List Workflow**, and then select **Next**.</span></span> 
 
4. <span data-ttu-id="f6576-120">Aktivieren Sie auf der nächsten Seite des Assistenten die Option **Ja, Zuordnung durchführen...** aus, und legen Sie dann die Dropdownfelder auf die folgenden Werte fest:</span><span class="sxs-lookup"><span data-stu-id="f6576-120">On the next page of the wizard, enable the  **Yes, associate ...** option and then set the drop down controls to the following values:</span></span>
    
   -  <span data-ttu-id="f6576-121">**Die Bibliothek oder Liste, der der Workflow zugeordnet werden soll**: Neue Mitarbeiter in Seattle</span><span class="sxs-lookup"><span data-stu-id="f6576-121">**The library or list to associate your workflow with**</span></span>
   -  <span data-ttu-id="f6576-122">**Die Verlaufsliste**: `<create new>`</span><span class="sxs-lookup"><span data-stu-id="f6576-122">**The history list ...**</span></span>
   -  <span data-ttu-id="f6576-123">**Die Aufgabenliste**: `<create new>`</span><span class="sxs-lookup"><span data-stu-id="f6576-123">**The Task list ...**</span></span>

5. <span data-ttu-id="f6576-124">Wählen Sie **Weiter** aus.</span><span class="sxs-lookup"><span data-stu-id="f6576-124">Select **Next**.</span></span>
    
6. <span data-ttu-id="f6576-125">Aktivieren Sie auf der letzten Seite des Assistenten die Option zum automatischen Starten des Workflows *nur*, wenn ein Element *geändert* wird.</span><span class="sxs-lookup"><span data-stu-id="f6576-125">On the last page of the wizard, enable *only* the option to start the workflow automatically when an item is *changed*.</span></span>
    
7. <span data-ttu-id="f6576-126">Wählen Sie **Fertig stellen** aus.</span><span class="sxs-lookup"><span data-stu-id="f6576-126">Select **Finish**.</span></span>
    
   <span data-ttu-id="f6576-127">Von den Office Developer Tools für Visual Studio wird Folgendes ausgeführt:</span><span class="sxs-lookup"><span data-stu-id="f6576-127">The Office Developer Tools for Visual Studio then do the following:</span></span>
      - <span data-ttu-id="f6576-128">Erstellen eines HR_Intake-Workflows im Ordner **Workflows** mit einer untergeordneten Workflow.xaml-Datei, die im Workflow-Designer geöffnet ist</span><span class="sxs-lookup"><span data-stu-id="f6576-128">Create an HR_Intake workflow in the **Workflow** folder, with a child Workflow.xaml file that is open in the workflow designer.</span></span>
      - <span data-ttu-id="f6576-129">Erstellen einer **WorkflowTaskList**-Listeninstanz, in der Aufgaben, die Teil des Workflows sind, erstellt und aktualisiert werden</span><span class="sxs-lookup"><span data-stu-id="f6576-129">Create a  **WorkflowTaskList** list instance where tasks that are part of the workflow are created and updated.</span></span>
      - <span data-ttu-id="f6576-130">Erstellen einer **WorkflowHistoryList**-Listeninstanz, die ein Protokoll der verschiedenen stattfindenden Schritte bei jeder Ausführung des Workflows ist</span><span class="sxs-lookup"><span data-stu-id="f6576-130">Create a  **WorkflowHistoryList** list instance, which is a log of the various steps in each execution of the workflow as they occur.</span></span>
    
8. <span data-ttu-id="f6576-131">Ziehen Sie die zwei neuen Listeninstanzen in den Ordner **Listen**.</span><span class="sxs-lookup"><span data-stu-id="f6576-131">Drag the two new list instances into the  **Lists** folder.</span></span>
    
## <a name="design-the-workflow"></a><span data-ttu-id="f6576-132">Entwerfen des Workflows</span><span class="sxs-lookup"><span data-stu-id="f6576-132">Design the workflow</span></span>

<span data-ttu-id="f6576-133">Der Workflow sendet eine E-Mail, um einen Mitarbeiter der Personalabteilung zu benachrichtigen, dass der neue Mitarbeiter die Orientierungsphase der **Tour durch das Gebäude** abgeschlossen hat und zum Ausfüllen der Aufnahmepersonalpapiere bereit ist.</span><span class="sxs-lookup"><span data-stu-id="f6576-133">The workflow sends an email to notify an HR staffer that the new employee has finished the **Tour of building** stage of orientation and is ready to fill out the HR intake paperwork.</span></span> <span data-ttu-id="f6576-134">Jede Änderung in einem vorhandenen Element der Liste **Neue Mitarbeiter in Seattle** löst den Workflow aus, aber der Workflow führt keine Aktionen aus, bis das Feld **Orientierungsphase** des Listenelements auf **HR paperwork** festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="f6576-134">Any change in an existing item on the **New Employees in Seattle** list triggers the workflow, but the workflow does nothing unless the **Orientation Stage** field of the list item is set to **HR paperwork**.</span></span> <span data-ttu-id="f6576-135">Dann wird eine E-Mail an einen Mitarbeiter der Personalabteilung gesendet und eine Aufgabe für diesen Mitarbeiter zur **WorkflowTaskList** hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="f6576-135">If it is, an email is sent to an HR staffer and a task for that employee is added to the **WorkflowTaskList**.</span></span> 

 > [!NOTE]
 > <span data-ttu-id="f6576-136">An verschiedenen Punkten während des Entwerfens Ihres Workflows wird ein blaues Rautensymbol mit einem Ausrufezeichen ( ![Ein kleines blaues Rautensymbol mit einem weißen Ausrufezeichen darin.](../images/f7b82a70-80fe-4e7e-a0f5-5a78cd12b367.PNG)</span><span class="sxs-lookup"><span data-stu-id="f6576-136">At various times when designing your workflow, a blue diamond symbol with an exclamation mark in it ( ![A small blue diamond shape with a white exclamation mark in it.](../images/f7b82a70-80fe-4e7e-a0f5-5a78cd12b367.PNG)</span></span> <span data-ttu-id="f6576-137">) für ein oder mehrere Elemente im Workflow-Designer angezeigt.</span><span class="sxs-lookup"><span data-stu-id="f6576-137">) will appear on one or more items in the workflow designer.</span></span> <span data-ttu-id="f6576-138">Diese weisen auf temporäre Fehler hin.</span><span class="sxs-lookup"><span data-stu-id="f6576-138">These report temporary errors.</span></span> <span data-ttu-id="f6576-139">(Bewegen Sie den Cursor über das Symbol, um eine kurze Meldung anzuzeigen, oder suchen Sie in der **Fehlerliste** von Visual Studio nach Details.) Hierbei handelt es sich um Nebeneffekte der Unvollständigkeit des Workflows.</span><span class="sxs-lookup"><span data-stu-id="f6576-139">, will appear on one or more items in the workflow designer. These report temporary errors. (Hover the cursor over the symbol to see a brief message, or look in the Visual Studio  **Error List** for details.) These are side effects of the incompleteness of the workflow. They should all be gone when you have finished this procedure.</span></span> <span data-ttu-id="f6576-140">Diese sollten nicht mehr vorhanden sein, wenn Sie das Verfahren abgeschlossen haben.</span><span class="sxs-lookup"><span data-stu-id="f6576-140">They should all be gone when you have finished this procedure.</span></span>

1. <span data-ttu-id="f6576-141">Öffnen Sie den Bereich **Toolbox** in Visual Studio, erweitern Sie den Knoten **SP - Liste**, und ziehen Sie dann **LookupSPListItem** in die **Sequenz** im Designer.</span><span class="sxs-lookup"><span data-stu-id="f6576-141">Open the  **Toolbox** pane in Visual Studio, expand the **SP - List** node, and then drag **LookupSPListItem** into the **Sequence** in the designer.</span></span>
    
2. <span data-ttu-id="f6576-142">Wählen Sie **LookupSPListItem** aus, um die Eigenschaften im Visual Studio-Bereich **Eigenschaften** anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="f6576-142">Select the  **LookupSPListItem** so that its properties appear in the Visual Studio **Properties** pane. Set the following properties to these values:</span></span> <span data-ttu-id="f6576-143">Legen Sie die Eigenschaften auf die folgenden Werte fest:</span><span class="sxs-lookup"><span data-stu-id="f6576-143">Set the following properties to these values:</span></span>
    
   -  <span data-ttu-id="f6576-144">**ItemID:** (aktuelles Element)</span><span class="sxs-lookup"><span data-stu-id="f6576-144">**ItemID:** (current item)</span></span>
   -  <span data-ttu-id="f6576-145">**ListID:** (aktuelle Liste)</span><span class="sxs-lookup"><span data-stu-id="f6576-145">**ListID:** (current list)</span></span>
   -  <span data-ttu-id="f6576-146">**DisplayName:** LookupCurrentNewEmployee</span><span class="sxs-lookup"><span data-stu-id="f6576-146">**DisplayName:** LookupCurrentNewEmployee</span></span>

   <span data-ttu-id="f6576-147">Der Bereich **Eigenschaften** sollte jetzt wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="f6576-147">The  **Properties** pane should now look like the following:</span></span>
   
    <span data-ttu-id="f6576-148">*Abbildung 1. Eigenschaftenbereich von LookupSPListItem*</span><span class="sxs-lookup"><span data-stu-id="f6576-148">*Figure 1. Properties pane of LookupSPListItem*</span></span>

    ![Eigenschaftenbereich der Workflowaktivität „Listenelement suchen“, wobei die Eigenschaften „ItemID“, „ListID“ und „DisplayName“ festgelegt sind](../images/60f3302e-ca9c-45be-b785-0c9f636181da.PNG)
 

3. <span data-ttu-id="f6576-150">Klicken Sie auf eine beliebige Stelle außerhalb des Bereichs, um die Änderungen zu speichern.</span><span class="sxs-lookup"><span data-stu-id="f6576-150">Select anywhere outside the pane to save your changes.</span></span> <span data-ttu-id="f6576-151">Die Oberfläche des Designers sollte jetzt wie folgt aussehen.</span><span class="sxs-lookup"><span data-stu-id="f6576-151">Choose  OK. The designer surface should now look like the following:</span></span>
    
    <span data-ttu-id="f6576-152">*Abbildung 2. Sequenz im Workflow-Designer*</span><span class="sxs-lookup"><span data-stu-id="f6576-152">*Sequence in the workflow designer*</span></span>

    ![Workflow-Designer mit dem Feld „Sequenz“ und einer darin enthaltenen Aktivität mit dem Namen „Aktuellen neuen Mitarbeiter suchen“](../images/c8fbf801-e8e4-444a-9d2e-c14e29f537de.PNG)

4. <span data-ttu-id="f6576-154">Wählen Sie den Link **Eigenschaften abrufen** in der (neu umbenannten) Aktivität **LookupCurrentNewEmployee** im Designer aus.</span><span class="sxs-lookup"><span data-stu-id="f6576-154">Click the **Get Properties** link inside the (newly renamed) **LookupCurrentNewEmployee** activity in the designer. This adds a GetDynamicValueProperties activity to the sequence.</span></span> <span data-ttu-id="f6576-155">Dadurch wird eine **GetDynamicValueProperties**-Aktivität zur Sequenz hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="f6576-155">This adds a **GetDynamicValueProperties** activity to the sequence.</span></span>
    
5. <span data-ttu-id="f6576-156">Wählen Sie den Text **Definieren...**</span><span class="sxs-lookup"><span data-stu-id="f6576-156">Select the **Define…**</span></span> <span data-ttu-id="f6576-157">in der Aktivität **GetDynamicValueProperties** aus.</span><span class="sxs-lookup"><span data-stu-id="f6576-157">text in the **GetDynamicValueProperties** activity.</span></span> <span data-ttu-id="f6576-158">Dadurch wird das Dialogfeld **Eigenschaften** geöffnet.</span><span class="sxs-lookup"><span data-stu-id="f6576-158">This will open the **Office Add-ins** dialog box.</span></span>
    
6. <span data-ttu-id="f6576-159">Legen Sie den **Entitätstyp** auf **Listenelement von** _Name_der_Listeninstanz_ fest, wobei _Name_der_Listeninstanz_ **Neue Mitarbeiter in Seattle** ist.</span><span class="sxs-lookup"><span data-stu-id="f6576-159">Set the **Entity Type** to **List Item of ** _list_instance_name_, where _list_instance_name_ is **New Employees in Seattle**.</span></span>
    
7. <span data-ttu-id="f6576-160">Wählen Sie in der Spalte **Pfad** die oberste Zelle aus, und wählen Sie dann **Orientierungsphase** aus der Dropdownliste aus.</span><span class="sxs-lookup"><span data-stu-id="f6576-160">In the **Path** column, click the top cell and then choose **Orientation Stage** from the drop down.</span></span>
 
8. <span data-ttu-id="f6576-161">Wählen Sie die Zelle darunter aus, und wählen Sie dann **Titel (Titel)** aus der Dropdownliste aus.</span><span class="sxs-lookup"><span data-stu-id="f6576-161">Select the cell under it, and then select **Title (Title)** from the drop-down.</span></span>
 
9. <span data-ttu-id="f6576-162">Wählen Sie **Variablen auffüllen** aus.</span><span class="sxs-lookup"><span data-stu-id="f6576-162">Select **Populate Variables**.</span></span> <span data-ttu-id="f6576-163">Dadurch Variablen namens **OrientationStage** und **Title** erstellt, und jeder wird der Wert der entsprechenden Felder im aktuellen Element der Liste **Neue Mitarbeiter in Seattle** zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="f6576-163">Click **Populate Variables**. This will create a variables named **OrientationStage** and Title and assign each of the value of corresponding fields in the current item of the **New Employees in Seattle** list. The Properties dialog should now look like the following:</span></span> <span data-ttu-id="f6576-164">Das Dialogfeld **Eigenschaften** sollte nun wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="f6576-164">The  **Properties** pane should now look like the following:</span></span>
    
   <span data-ttu-id="f6576-165">*Abbildung 3. Dialogfeld „Eigenschaften“ der Workflowaktivität*</span><span class="sxs-lookup"><span data-stu-id="f6576-165">*Properties dialog of workflow activity*</span></span>

   ![Das Dialogfeld "Eigenschaften" für die Aktivität "Dynamische Werte abrufen", wobei der Entitätstyp auf Elemente der Liste "Neue Mitarbeiter" festgelegt ist, und Variablen mit dem Namen "Title" und "OrientationStage", die Feldern mit dem gleichen Namen zugewiesen sind.](../images/36a841e7-ce1b-444c-9bfe-7cdc56399ec1.PNG)
 

10. <span data-ttu-id="f6576-167">Wählen Sie **OK** aus.</span><span class="sxs-lookup"><span data-stu-id="f6576-167">Select **OK**.</span></span> <span data-ttu-id="f6576-168">Die Designeroberfläche sollte jetzt wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="f6576-168">Choose  OK. The designer surface should now look like the following:</span></span>
    
    <span data-ttu-id="f6576-169">*Abbildung 4. Workflow-Designer*</span><span class="sxs-lookup"><span data-stu-id="f6576-169">*Figure 4. Workflow designer*</span></span>

    ![Der Workflow-Designer mit zwei Aktivitäten: „Listenelement suchen“ und „Dynamische Werte abrufen“.](../images/cd8eb456-d883-491a-b171-38c1b9f64018.PNG)

11. <span data-ttu-id="f6576-171">Öffnen Sie den Bereich **Toolbox** in Visual Studio, erweitern Sie den Knoten **Ablaufsteuerung**, und ziehen Sie dann **Wenn** in den unteren Bereich von **Sequenz** unterhalb von **GetDynamicValueProperties**.</span><span class="sxs-lookup"><span data-stu-id="f6576-171">Open the  **Toolbox** pane in Visual Studio, expand the **Control Flow** node, and then drag **If** into the bottom of the **Sequence** below the **GetDynamicValueProperties**.</span></span>
 
12. <span data-ttu-id="f6576-172">Geben Sie in das Feld **Bedingung** von **Wenn** den Wert **OrientationStage=="HR paperwork"** ein.</span><span class="sxs-lookup"><span data-stu-id="f6576-172">In the  **Condition** box of the **If**, enter OrientationStage=="HR paperwork".</span></span>
    
13. <span data-ttu-id="f6576-173">Öffnen Sie den Bereich **Toolbox** in Visual Studio, erweitern Sie den Knoten **SP - Hilfsprogramme**, und ziehen Sie dann **E-Mail** in das Feld **Dann** der **Wenn**-Aktivität.</span><span class="sxs-lookup"><span data-stu-id="f6576-173">Open the  **Toolbox** pane in Visual Studio, expand the **SP - Utilities** node, and then drag **Email** into the **Then** box of the **If** activity.</span></span>
    
14. <span data-ttu-id="f6576-174">Wählen Sie die **E-Mail**-Aktivität aus.</span><span class="sxs-lookup"><span data-stu-id="f6576-174">Select the **Email** activity.</span></span> <span data-ttu-id="f6576-175">Legen Sie im Bereich **Eigenschaften** die Werte für die Eigenschaften **Textkörper**, **Betreff** und **An** fest.</span><span class="sxs-lookup"><span data-stu-id="f6576-175">In the **Properties** pane, set the values of the **Body**, **Subject**, and **To** properties.</span></span> <span data-ttu-id="f6576-176">Wählen Sie in jedem Fall die Popupschaltfläche **...**</span><span class="sxs-lookup"><span data-stu-id="f6576-176">In each case, choose the callout button **. . .**</span></span> <span data-ttu-id="f6576-177">für die Eigenschaft, und verwenden Sie den sich öffnenden **Ausdrucks-Editor**, um den Wert der Eigenschaft wie in der folgenden Tabelle festzulegen.</span><span class="sxs-lookup"><span data-stu-id="f6576-177">for the property and use the **Expression Editor** that opens to set the property's value as in the following table.</span></span> <span data-ttu-id="f6576-178">Da es sich dabei um C#-Zeichenfolgenausdrücke handelt, müssen Sie die Anführungszeichen exakt wie gezeigt verwenden.</span><span class="sxs-lookup"><span data-stu-id="f6576-178">These are C# string expressions, so use quotation marks exactly as shown.</span></span> <span data-ttu-id="f6576-179">`Title` ist hier eine Variable, die Sie zuvor dem Feld **Titel** des Listenelements zugewiesen haben (das den Namen des Mitarbeiters enthält).</span><span class="sxs-lookup"><span data-stu-id="f6576-179">The `Title` here is a variable that you assigned earlier to the **Title** field of the list item (which holds the name of the employee).</span></span>
    
    -  <span data-ttu-id="f6576-180">**Text:** `Title + " is waiting in the lobby to fill out benefits and employment forms."`</span><span class="sxs-lookup"><span data-stu-id="f6576-180">**Body:** `Title + " is waiting in the lobby to fill out benefits and employment forms."`</span></span>
    -  <span data-ttu-id="f6576-181">**Betreff:** `Title + " is ready for HR paperwork"`</span><span class="sxs-lookup"><span data-stu-id="f6576-181">**Subject:** `Title + " is ready for HR paperwork"`</span></span>
    -  <span data-ttu-id="f6576-182">**An:** `new System.Collections.ObjectModel.Collection<string>() {"your_O365_email"}`</span><span class="sxs-lookup"><span data-stu-id="f6576-182">**To:** `new System.Collections.ObjectModel.Collection<string>() {"your_O365_email"}`</span></span>
    
    <span data-ttu-id="f6576-183">Ersetzen Sie den Platzhalter *your_O365_email* durch die Identität, mit der Sie sich bei Ihrem Office 365-Entwicklerkonto anmelden, z. B. `*alias*@*O365domain*.sharepoint.com`.</span><span class="sxs-lookup"><span data-stu-id="f6576-183">Replace the placeholder,  your_O365_email  , with the identity that you use to login to your Office 365 developer account, such as alias  O365domain  .sharepoint.com. This is a C# string so it must be in quotation marks.</span></span> <span data-ttu-id="f6576-184">Da es sich hier um eine C#-Zeichenfolge handelt, muss diese in Anführungszeichen eingeschlossen sein.</span><span class="sxs-lookup"><span data-stu-id="f6576-184">This is a C# string so it must be in quotation marks.</span></span>
    
15. <span data-ttu-id="f6576-185">Öffnen Sie den Bereich **Toolbox** in Visual Studio, erweitern Sie den Knoten **Runtime**, und ziehen Sie dann **TerminateWorkflow** in das Feld **Sonst** der **Wenn**-Aktivität.</span><span class="sxs-lookup"><span data-stu-id="f6576-185">Open the  **Toolbox** pane in Visual Studio, expand the **Runtime** node, and then drag **TerminateWorkflow** into the **Else** box of the **If** activity.</span></span>
    
16. <span data-ttu-id="f6576-186">Wählen Sie die **TerminateWorkflow**-Aktivität aus, und legen Sie im Bereich **Eigenschaften** den **Grund** auf Folgendes fest (*einschließlich der Anführungszeichen*): `"Not at HR paperwork stage."`.</span><span class="sxs-lookup"><span data-stu-id="f6576-186">Select the  TerminateWorkflow activity and in the Properties pane, set the Reason to the following, * including the quotation marks*  :"Not at HR paperwork stage.". The designer should now look the following:</span></span> <span data-ttu-id="f6576-187">Der Designer sollte jetzt wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="f6576-187">Choose  OK. The designer surface should now look like the following:</span></span>
    
    <span data-ttu-id="f6576-188">*Abbildung 5. Workflow-Designer, wenn der Workflow abgeschlossen ist*</span><span class="sxs-lookup"><span data-stu-id="f6576-188">*Workflow designer when the workflow is complete*</span></span>

    ![Der Workflow-Designer mit Aktivitäten für "Listenelement suchen", "Dynamischen Wert abrufen" und einer "Wenn-Dann-Sonst"-Struktur. E-Mail ist die Aktivität im Teil "Dann" und "Workflow beenden" ist die Aktivität für "Sonst".](../images/c1230e3b-d149-413c-aa66-d258250a4512.PNG)
 

## <a name="run-and-test-the-add-in"></a><span data-ttu-id="f6576-191">Ausführen und Testen des Add-Ins</span><span class="sxs-lookup"><span data-stu-id="f6576-191">Run and test the add-in</span></span>

1. <span data-ttu-id="f6576-192">Verwenden Sie die F5-Taste, um Ihr Add-In bereitzustellen und auszuführen.</span><span class="sxs-lookup"><span data-stu-id="f6576-192">Use the F5 key to deploy and run your add-in.</span></span> <span data-ttu-id="f6576-193">Visual Studio führt eine temporäre Installation des Add-Ins auf Ihrer SharePoint-Testwebsite durch und führt das Add-In sofort aus.</span><span class="sxs-lookup"><span data-stu-id="f6576-193">Use the F5 key to deploy and run your add-in. Visual Studio makes a temporary installation of the add-in on your test SharePoint site and immediately runs the add-in.</span></span> <span data-ttu-id="f6576-194">Die Konsole **Diensttesthost** des Workflow-Managers wird ebenfalls geöffnet.</span><span class="sxs-lookup"><span data-stu-id="f6576-194">The Workflow Manager's **Test Service Host** console also opens.</span></span>
    
2. <span data-ttu-id="f6576-195">Wenn die Standardseite des Add-Ins geöffnet wird, öffnen Sie eins der Elemente zum Bearbeiten, und legen Sie den Wert von **OrientationStage** auf **HR paperwork** fest.</span><span class="sxs-lookup"><span data-stu-id="f6576-195">When the add-in's default page opens,  open one of the items for editing, and set the value of **Orientation Stage** to **HR paperwork**.</span></span> 
    
   <span data-ttu-id="f6576-196">In der Konsole **Diensttesthost** wird der Hinweis angezeigt, dass der Workflow gestartet wurde.</span><span class="sxs-lookup"><span data-stu-id="f6576-196">In the  **Test Service Host** console, an indication appears that the workflow has started. Shortly after, there is an indication that the workflow has completed. The following is an example:</span></span> <span data-ttu-id="f6576-197">Kurz danach wird der Hinweis angezeigt, dass der Workflow abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="f6576-197">Shortly after, there is an indication that the workflow has completed.</span></span> <span data-ttu-id="f6576-198">Es folgt ein Beispiel:</span><span class="sxs-lookup"><span data-stu-id="f6576-198">The following is an example:</span></span>
 
   <span data-ttu-id="f6576-199">*Abbildung 6. Konsole „Diensttesthost“*</span><span class="sxs-lookup"><span data-stu-id="f6576-199">*Figure 6. Test Service Host console*</span></span>

   ![Das Workflowfenster "Test Service Host" mit einer Zeile, die besagt, dass der Workflow gestartet wurde, gefolgt von einer Zeile, die besagt, dass der Workflow beendet wurde. Die GUID der Workflowinstanz befindet sich am Anfang jeder Zeile.](../images/2422936d-7ef6-4c90-a03f-30053fbb9743.PNG)
 
    > [!NOTE]
    > <span data-ttu-id="f6576-202">Wenn die Konsole **Diensttesthost** nicht geöffnet wird, müssen Sie möglicherweise das Workflow-Debugging aktivieren.</span><span class="sxs-lookup"><span data-stu-id="f6576-202">If the  **Test Service Host** console does not open, you may need to enable workflow debugging.</span></span> <span data-ttu-id="f6576-203">Klicken Sie im **Projektmappen-Explorer** mit der rechten Maustaste auf den Projektnamen, und wählen Sie **Eigenschaften** aus.</span><span class="sxs-lookup"><span data-stu-id="f6576-203">Right-click the project name in **Solution Explorer** and select **Properties**.</span></span> <span data-ttu-id="f6576-204">Öffnen Sie im Bereich **Eigenschaften** die Registerkarte **SharePoint**, und aktivieren Sie  das Kontrollkästchen **Workflow-Debugging aktivieren**.</span><span class="sxs-lookup"><span data-stu-id="f6576-204">Open the **SharePoint** tab on the **Properties** pane and select the **Enable Workflow debugging** check box.</span></span>

3. <span data-ttu-id="f6576-205">Wechseln Sie zum E-Mail-Posteingang (Outlook) Ihres Office 365-Entwicklerkontos.</span><span class="sxs-lookup"><span data-stu-id="f6576-205">Go to the email inbox (Outlook) of your Office 365 developer account.</span></span> <span data-ttu-id="f6576-206">Dort finden Sie eine E-Mail mit dem Betreff „*Employee* is ready for HR paperwork“, wobei *Employee* der Name des Mitarbeiters ist, dessen Element Sie bearbeitet haben.</span><span class="sxs-lookup"><span data-stu-id="f6576-206">There is an email with the subject "*Employee* is ready for HR paperwork" where *Employee* is the name of the employee whose item you edited.</span></span> <span data-ttu-id="f6576-207">Der Textkörper der E-Mail lautet „*Employee* is waiting in the lobby to fill out benefits and employment forms.“</span><span class="sxs-lookup"><span data-stu-id="f6576-207">The body of the email says "*Employee* is waiting in the lobby to fill out benefits and employment forms."</span></span> <span data-ttu-id="f6576-208">Es folgt ein Beispiel:</span><span class="sxs-lookup"><span data-stu-id="f6576-208">The following is an example:</span></span>
    
   <span data-ttu-id="f6576-209">*Abbildung 7. Vom Workflow gesendete E-Mail*</span><span class="sxs-lookup"><span data-stu-id="f6576-209">*Figure 7. Email sent by workflow*</span></span>

   ![Eine E-Mail-Nachricht in Outlook aus dem Workflow mit dem Betreff "Cassie Hicks ist bereit für die Schreibarbeiten der Personalabteilung" und dem Nachrichtentext "Cassie Hicks wartet in der Lobby, um Formulare für Zusatzleistungen und Dienstverhältnisse auszufüllen."](../images/7b1d8f47-9c34-441e-af6a-3af4a8c65533.PNG)

   > [!TIP]
   > <span data-ttu-id="f6576-211">Wenn der Workflow gestartet, aber niemals abgeschlossen und die E-Mail nicht gesendet wird, versuchen Sie, die Debugsitzung zu beenden, und drücken Sie einige Male erneut F5, bevor Sie davon ausgehen, dass etwas in Ihrem Code nicht in Ordnung ist.</span><span class="sxs-lookup"><span data-stu-id="f6576-211">If the workflow begins but never completes, and the email is not sent, try ending the debugging session and trying F5 again a few times before you conclude there is something wrong in your code. Sometimes the problem is in sposhort.</span></span> <span data-ttu-id="f6576-212">Manchmal liegt das Problem bei SharePoint Online.</span><span class="sxs-lookup"><span data-stu-id="f6576-212">Sometimes the problem is in SharePoint Online.</span></span> <span data-ttu-id="f6576-213">Wenn weiterhin Probleme auftreten, versuchen Sie, einen Inhaltstyp namens **ListFieldsContentType**, falls dieser noch nicht vorhanden ist, zum Abschnitt **ContentTypes** der Datei „schema.xml“ hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="f6576-213">If you are still having problems, try adding a content type called **ListFieldsContentType**, if there isn't one already, to the **ContentTypes** section of the schema.xml file. The following is an example of the markup.</span></span> <span data-ttu-id="f6576-214">Im Folgenden finden Sie ein Beispiel für das Markup:</span><span class="sxs-lookup"><span data-stu-id="f6576-214">The following is an example of the markup:</span></span> 
   
   > `<ContentType ID="0x0100781dd48170b94fdc9706313c82b3d04c" Name="ListFieldsContentType" Hidden="TRUE"></ContentType>`
   
   > <span data-ttu-id="f6576-215">Kopieren Sie den gesamten **FieldRefs**-Abschnitt des Inhaltstyps **NewEmployee** in diesen neuen Inhaltstyp.</span><span class="sxs-lookup"><span data-stu-id="f6576-215">Then copy the whole of the FieldRefs section of the NewEmployee content type into this new content type.</span></span> <span data-ttu-id="f6576-216">Speichern Sie das Projekt, ziehen Sie es zurück, und drücken Sie erneut F5.</span><span class="sxs-lookup"><span data-stu-id="f6576-216">Save the project, retract, and try F5 again.</span></span>

4. <span data-ttu-id="f6576-217">Schließen Sie zum Beenden der Debugsitzung das Browserfenster, oder beenden Sie das Debuggen in Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="f6576-217">To end the debugging session, close the browser window or stop debugging in Visual Studio. Each time that you press F5, Visual Studio will retract the previous version of the add-in and install the latest one.</span></span> <span data-ttu-id="f6576-218">Jedes Mal, wenn Sie F5 drücken, zieht Visual Studio die vorherige Version des Add-Ins zurück und installiert die neueste.</span><span class="sxs-lookup"><span data-stu-id="f6576-218">Each time that you select F5, Visual Studio retracts the previous version of the add-in and installs the latest one.</span></span>
    
5. <span data-ttu-id="f6576-219">Da Sie mit diesem Add-In und dieser Visual Studio-Lösung in anderen Artikeln arbeiten werden, hat es sich bewährt, das Add-In ein letztes Mal zurückzuziehen, wenn Sie Ihre Arbeit daran für eine Weile abgeschlossen haben.</span><span class="sxs-lookup"><span data-stu-id="f6576-219">You will work with this add-in and Visual Studio solution in other articles, and it's a good practice to retract the add-in one last time when you are done working with it for a while. Right-click the project in  Solution Explorer and choose Retract.</span></span> <span data-ttu-id="f6576-220">Klicken Sie mit der rechten Maustaste auf das Projekt im **Projektmappen-Explorer**, und wählen Sie **Zurückziehen** aus.</span><span class="sxs-lookup"><span data-stu-id="f6576-220">Right-click the project in  **Solution Explorer** and choose **Retract**.</span></span>
    

## <a name="next-steps"></a><span data-ttu-id="f6576-221">Nächste Schritte</span><span class="sxs-lookup"><span data-stu-id="f6576-221">Next steps</span></span>
<span data-ttu-id="f6576-222"><a name="Nextsteps"> </a></span><span class="sxs-lookup"><span data-stu-id="f6576-222"></span></span>

<span data-ttu-id="f6576-223">Im nächsten Artikel dieser Reihe [fügen Sie eine benutzerdefinierte Seite und Formatvorlage zu einem von SharePoint gehosteten SharePoint-Add-In hinzu](add-a-custom-page-and-style-to-a-sharepoint-hosted-sharepoint-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="f6576-223">In the next article in this series, you'll add a custom page and style to the SharePoint Add-in:  [Add a custom page and style to a SharePoint-hosted SharePoint Add-in](add-a-custom-page-and-style-to-a-sharepoint-hosted-sharepoint-add-in.md).</span></span>
 

 

